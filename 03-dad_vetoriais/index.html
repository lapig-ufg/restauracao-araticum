<!doctype html><html lang=pt class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A Articulação pela Restauração do Cerrado é uma rede colaborativa e multisetorial, que visa atuar como uma coalizão cujo objetivo é promover a restauração em larga escala do Bioma."><meta name=author content="Luiz Pascoal, Renato Gomes Silvério e Tharles de Sousa Andrade"><link href=https://araticum.lapig.iesa.ufg.br/03-dad_vetoriais/ rel=canonical><link href=../01-guia_relatorios/ rel=prev><link href=../03-dad_rasters/ rel=next><link rel=icon href=../imgs/logos/favicon.ico><meta name=generator content="mkdocs-1.5.2, mkdocs-material-9.2.7"><title>Vetoriais - Plataforma da Rede de Articulação pela Restauração do Cerrado</title><link rel=stylesheet href=../assets/stylesheets/main.046329b4.min.css><link rel=stylesheet href=../assets/stylesheets/palette.85d0ee34.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=blue-grey> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#dados-vetoriais class=md-skip> Ir para o conteúdo </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Cabeçalho> <a href=.. title="Plataforma da Rede de Articulação pela Restauração do Cerrado" class="md-header__button md-logo" aria-label="Plataforma da Rede de Articulação pela Restauração do Cerrado" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Plataforma da Rede de Articulação pela Restauração do Cerrado </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Vetoriais </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=blue-grey aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Buscar placeholder=Buscar autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Pesquisar> <a href=javascript:void(0) class="md-search__icon md-icon" title=Compartilhar aria-label=Compartilhar data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Limpar aria-label=Limpar tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Inicializando a pesquisa </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/lapig-ufg/restauracao-araticum title="Ir ao repositório" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> lapig-ufg/restauracao-araticum </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Abas data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> HOME </a> </li> <li class=md-tabs__item> <a href=../01-guia_dados_geograficos/ class=md-tabs__link> Guia do usuário </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> Dados </a> </li> <li class=md-tabs__item> <a href=../02-arq_geral/ class=md-tabs__link> Arquitetura de Software </a> </li> <li class=md-tabs__item> <a href=../04-metricas_de_avaliacao/ class=md-tabs__link> Métricas de Avaliação </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navegação data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Plataforma da Rede de Articulação pela Restauração do Cerrado" class="md-nav__button md-logo" aria-label="Plataforma da Rede de Articulação pela Restauração do Cerrado" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> Plataforma da Rede de Articulação pela Restauração do Cerrado </label> <div class=md-nav__source> <a href=https://github.com/lapig-ufg/restauracao-araticum title="Ir ao repositório" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> lapig-ufg/restauracao-araticum </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> HOME </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Guia do usuário </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Guia do usuário </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../01-guia_dados_geograficos/ class=md-nav__link> <span class=md-ellipsis> Dados Geográficos </span> </a> </li> <li class=md-nav__item> <a href=../01-guia_metricas_de_qualidade/ class=md-nav__link> <span class=md-ellipsis> Métricas de Qualidade </span> </a> </li> <li class=md-nav__item> <a href=../01-guia_funcionalidades/ class=md-nav__link> <span class=md-ellipsis> Funcionalidades </span> </a> </li> <li class=md-nav__item> <a href=../01-guia_relatorios/ class=md-nav__link> <span class=md-ellipsis> Relatórios </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Dados </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Dados </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Vetoriais </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Vetoriais </span> </a> <nav class="md-nav md-nav--secondary" aria-label=Índice> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Índice </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#banco-de-dados-e-mer class=md-nav__link> Banco de dados e MER </a> <nav class=md-nav aria-label="Banco de dados e MER"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#principais-entidades class=md-nav__link> Principais entidades </a> <nav class=md-nav aria-label="Principais entidades"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#prodes_cerrado-e-deter_cerrado class=md-nav__link> prodes_cerrado e deter_cerrado </a> </li> <li class=md-nav__item> <a href=#regions class=md-nav__link> regions </a> </li> <li class=md-nav__item> <a href=#car_cerrado class=md-nav__link> car_cerrado </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#processo-de-atualizacao class=md-nav__link> Processo de atualização </a> <nav class=md-nav aria-label="Processo de atualização"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#prodes-cerrado class=md-nav__link> PRODES Cerrado </a> </li> <li class=md-nav__item> <a href=#deter-cerrado class=md-nav__link> DETER Cerrado </a> </li> <li class=md-nav__item> <a href=#cadastro-ambiental-rural-car class=md-nav__link> Cadastro Ambiental Rural (CAR) </a> </li> <li class=md-nav__item> <a href=#cruzamentos-espaciais-entre-os-dados class=md-nav__link> Cruzamentos espaciais entre os dados </a> <nav class=md-nav aria-label="Cruzamentos espaciais entre os dados"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#prodes-e-deter-cerrado-com-o-car class=md-nav__link> PRODES e DETER-Cerrado com o CAR </a> </li> <li class=md-nav__item> <a href=#prodes-e-deter-cerrado-com-o-car_1 class=md-nav__link> PRODES e DETER-Cerrado com o CAR </a> </li> <li class=md-nav__item> <a href=#prodes-cerrado-com-os-pontos-da-validacao-de-campo class=md-nav__link> PRODES-Cerrado com os pontos da Validação de Campo </a> </li> <li class=md-nav__item> <a href=#prodes-cerrado-com-os-pontos-da-validacao-amostral class=md-nav__link> PRODES-Cerrado com os pontos da Validação Amostral </a> </li> <li class=md-nav__item> <a href=#prodes-cerrado-acumulado-em-todas-regioes-municipios-e-estados class=md-nav__link> PRODES-Cerrado acumulado em todas regiões (Municípios e Estados) </a> </li> <li class=md-nav__item> <a href=#prodes-cerrado-com-todas-regioes-municipios-e-estados-em-relacao-ao-uso-do-solo class=md-nav__link> PRODES-Cerrado com todas regiões (Municípios e Estados) em relação ao uso do solo </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../03-dad_rasters/ class=md-nav__link> <span class=md-ellipsis> Rasters </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Arquitetura de Software </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Arquitetura de Software </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../02-arq_geral/ class=md-nav__link> <span class=md-ellipsis> Visão geral </span> </a> </li> <li class=md-nav__item> <a href=../02-arq_servidor_de_mapas/ class=md-nav__link> <span class=md-ellipsis> Servidor de mapas </span> </a> </li> <li class=md-nav__item> <a href=../02-arq_servidor_de_aplicacao/ class=md-nav__link> <span class=md-ellipsis> Servidor de aplicação </span> </a> </li> <li class=md-nav__item> <a href=../02-arq_execucao_dpat/ class=md-nav__link> <span class=md-ellipsis> Deployment da arquitetura do Cerrado DPAT </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../04-metricas_de_avaliacao/ class=md-nav__link> <span class=md-ellipsis> Métricas de Avaliação </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=Índice> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Índice </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#banco-de-dados-e-mer class=md-nav__link> Banco de dados e MER </a> <nav class=md-nav aria-label="Banco de dados e MER"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#principais-entidades class=md-nav__link> Principais entidades </a> <nav class=md-nav aria-label="Principais entidades"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#prodes_cerrado-e-deter_cerrado class=md-nav__link> prodes_cerrado e deter_cerrado </a> </li> <li class=md-nav__item> <a href=#regions class=md-nav__link> regions </a> </li> <li class=md-nav__item> <a href=#car_cerrado class=md-nav__link> car_cerrado </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#processo-de-atualizacao class=md-nav__link> Processo de atualização </a> <nav class=md-nav aria-label="Processo de atualização"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#prodes-cerrado class=md-nav__link> PRODES Cerrado </a> </li> <li class=md-nav__item> <a href=#deter-cerrado class=md-nav__link> DETER Cerrado </a> </li> <li class=md-nav__item> <a href=#cadastro-ambiental-rural-car class=md-nav__link> Cadastro Ambiental Rural (CAR) </a> </li> <li class=md-nav__item> <a href=#cruzamentos-espaciais-entre-os-dados class=md-nav__link> Cruzamentos espaciais entre os dados </a> <nav class=md-nav aria-label="Cruzamentos espaciais entre os dados"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#prodes-e-deter-cerrado-com-o-car class=md-nav__link> PRODES e DETER-Cerrado com o CAR </a> </li> <li class=md-nav__item> <a href=#prodes-e-deter-cerrado-com-o-car_1 class=md-nav__link> PRODES e DETER-Cerrado com o CAR </a> </li> <li class=md-nav__item> <a href=#prodes-cerrado-com-os-pontos-da-validacao-de-campo class=md-nav__link> PRODES-Cerrado com os pontos da Validação de Campo </a> </li> <li class=md-nav__item> <a href=#prodes-cerrado-com-os-pontos-da-validacao-amostral class=md-nav__link> PRODES-Cerrado com os pontos da Validação Amostral </a> </li> <li class=md-nav__item> <a href=#prodes-cerrado-acumulado-em-todas-regioes-municipios-e-estados class=md-nav__link> PRODES-Cerrado acumulado em todas regiões (Municípios e Estados) </a> </li> <li class=md-nav__item> <a href=#prodes-cerrado-com-todas-regioes-municipios-e-estados-em-relacao-ao-uso-do-solo class=md-nav__link> PRODES-Cerrado com todas regiões (Municípios e Estados) em relação ao uso do solo </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=dados-vetoriais>Dados Vetoriais<a class=headerlink href=#dados-vetoriais title="Permanent link">&para;</a></h1> <p>No Cerrado DPAT todos os dados vetoriais estão armazenados em um banco de dados PostgreSQL. O último backup deste banco pode ser encontrado no <a href="https://drive.google.com/file/d/19nVhry3bvHpV_oY861saBV9prXpfnFtd/view?usp=sharing">link</a> no arquivo <code>BKP_BANCO_DADOS_FIP_CERRADO.tar.gz</code>. </p> <h2 id=banco-de-dados-e-mer>Banco de dados e MER<a class=headerlink href=#banco-de-dados-e-mer title="Permanent link">&para;</a></h2> <p>No modelo de entidade relacionamento (MER) do banco de dados, apresentado a seguir, as tabelas foram agrupadas em duas categorias:</p> <ul> <li> <p><strong>Entidades Principais (cinza)</strong>: estrutura responsável por armazenar os dados consolidados utilizados no Cerado DPAT, conforme foram disponibilizados pela sua instituição. O Cerrado DPAT conta com mais de 20 entidades, porém, em sua maioria são utilizados apenas como camadas de dados, sem realização de cruzamentos, portanto, as entidades utilizadas neste MER foram as utilizadas em diversos cruzamentos espaciais para análise.</p> </li> <li> <p><strong>Tabelas com cruzamentos espaciais</strong>: estrutura responsável por armazenar resultados de cruzamentos espaciais entre diferentes entidades do Cerrado DPAT. Em sua maioria, os cruzamentos espaciais resultam em referências entre chaves únicas, além do resultado de algum tipo de processamento, como por exemplo, <em>area_desmat</em>, que representa a área desmatada (detectada pelo PRODES-Cerrado) em uma propriedade rural, que é armazenada pela tabela <em>car_desmat</em>.</p> </li> </ul> <p><img alt=MER. src=../imgs/03/mer.png></p> <h3 id=principais-entidades>Principais entidades<a class=headerlink href=#principais-entidades title="Permanent link">&para;</a></h3> <h4 id=prodes_cerrado-e-deter_cerrado>prodes_cerrado e deter_cerrado<a class=headerlink href=#prodes_cerrado-e-deter_cerrado title="Permanent link">&para;</a></h4> <p>Entidades (tabelas) responsáveis por armazenar os polígonos PRODES-Cerrado e DETER-Cerrado consolidados que são apresentados no Cerrado DPAT. O identificador único <strong>(gid)</strong> destas tabelas são usadas em entidades auxiliares, tais como, <strong>pontos_campo</strong>, <strong>validacao_amostral</strong>, <strong>car_desmat</strong> e outras para identificar seu cruzamento com as mesmas, portanto, não se deve alterá-lo.</p> <h4 id=regions>regions<a class=headerlink href=#regions title="Permanent link">&para;</a></h4> <p>Entidade responsável por armazenar todas as regiões (municípios e estados) do Cerrado. A coluna <code>value</code> apresenta o valor de identificação da região e <code>type</code> diferencia municípios (anotado como <strong>city</strong>) dos estados (anotado como <strong>state</strong>).</p> <h4 id=car_cerrado>car_cerrado<a class=headerlink href=#car_cerrado title="Permanent link">&para;</a></h4> <p>Entidade responsável por armazenar os dados de cada propriedade rural presente no Cerrado. Cada propriedade possui um identificador único anotado pela variável <code>idt_imovel</code>. Este valor é utilizado para associar cada propriedade rural com a reserva legal (tabela <code>geo_car_reserva_legal_cerrado</code>), com áreas de preservação permanente (tabela <code>geo_car_app_cerrado</code>) e nascentes (tabela <code>geo_car_nascente_cerrado</code>).</p> <h2 id=processo-de-atualizacao>Processo de atualização<a class=headerlink href=#processo-de-atualizacao title="Permanent link">&para;</a></h2> <p>Diversos dados presentes na plataforma Cerrado DPAT são periodicamente atualizados pelas instituições competentes. Desta forma, a medida que os mesmos são atualizados e disponibilizados pelas instituições também é necessário realizar a atualização no banco de dados do Cerrado DPAT.</p> <p>Os comandos a seguir foram todos desenvolvidos na linguagem <code>sql</code>, portanto podem ser executados em qualquer ambiente que realize a conexão com PostgreSQL, tais como o <a href=https://www.pgadmin.org/ >pgAdmin</a> ou o próprio ambiente nativo conhecido como <code>psql</code>. A fim de facilitar, pode-se criar um arquivo de extensão <code>.sql</code> e executá-lo da seguinte forma:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>psql &quot;dbname=&#39;&lt;db_name&gt;&#39; user=&#39;&lt;db_user&gt;&#39; password=&#39;&lt;db_pwd&gt;&#39; host=&#39;&lt;db_host&#39;&quot; -f &lt;path_to_&gt;/yourFileName.sql
</code></pre></div> <h3 id=prodes-cerrado>PRODES Cerrado<a class=headerlink href=#prodes-cerrado title="Permanent link">&para;</a></h3> <p>Devido a divulgação anual do PRODES-Cerrado é necessário realizar a sua atualização sempre que um novo produto é lançado. Desta forma, deve-se visitar o site do <a href=http://terrabrasilis.dpi.inpe.br/downloads/ >Terrabrasilis</a> para verificar se um novo PRODES-Cerrado foi lançado e realizar o seu download em Shapefile. </p> <p>A fim de demonstrar todos os procedimentos necessários após uma nova atualização do PRODES-Cerrado, iremos utilizar o mesmo processo realizado na atualização do PRODES-Cerrado 2019 executada em Janeiro de 2020. Na ocasião o INPE disponibilizou um Shapefile único para o PRODES-Cerrado 2019 com uma estrutura própria detalhada a seguir. Atualmente, pode-se encontrar todos os desmatamentos PRODES-Cerrado em um Shapefile único no <a href=http://terrabrasilis.dpi.inpe.br/download/dataset/cerrado-prodes/vector/yearly_deforestation_2002_2019_cerrado_biome.zip>link</a>. Porém é importante ressaltar que o padrão das colunas disponibilizados pelo INPE pode ser alterada em atualizações futuras.</p> <p>Após download do shapefile único contendo os desmatamentos PRODES-Cerrado 2019, primeiramente é necessário importar os dados para o banco de dados, alterando corretamente os parâmetros <host_address> <db_user> <db_name> abaixo:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>shp2pgsql<span class=w> </span>-s<span class=w> </span><span class=m>4674</span><span class=w> </span>-W<span class=w> </span><span class=s2>&quot;UTF-8&quot;</span><span class=w> </span>ProdesCerrado_2019_incremento.shp<span class=w> </span>public.prodes2019<span class=w> </span><span class=p>|</span><span class=w> </span>psql<span class=w> </span>-h<span class=w> </span>&lt;host_address&gt;<span class=w> </span>-U<span class=w> </span>&lt;db_user&gt;<span class=w> </span>-d<span class=w> </span>&lt;db_name&gt;
</code></pre></div> <p>O comando acima importa os dados do Shapefile em uma tabela nomeada <code>prodes2019</code>. Na ocasião, o PRODES-Cerrado 2019 foi disponibilizado sem o campo de identificação em qual município aquele desmatamento ocorreu e com a coluna <code>state</code> que identificava os estados pelo nome por extenso. Portanto, inicialmente deve-se alterar o padrão dos estados para utilizar o campo <em>uf</em> com apenas 2 caracteres.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>prodes2019</span><span class=w> </span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=k>ADD</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>uf</span><span class=w> </span><span class=nb>character</span><span class=w> </span><span class=nb>varying</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
</code></pre></div> <p>Em seguida, preencha o campo <code>uf</code> com o seguinte comando:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=k>update</span><span class=w> </span><span class=n>prodes2019</span><span class=w> </span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=k>set</span><span class=w> </span><span class=n>uf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>CASE</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=w>    </span><span class=k>when</span><span class=w> </span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PARÁ&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;PA&#39;</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>    </span><span class=k>when</span><span class=w> </span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;MATO GROSSO&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MT&#39;</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PIAUÍ&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;PI&#39;</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;BAHIA&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;BA&#39;</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;MARANHÃO&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MA&#39;</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;TOCANTINS&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;TO&#39;</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;MATO GROSSO DO SUL&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MS&#39;</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;MINAS GERAIS&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MG&#39;</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PARANÁ&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;PR&#39;</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;RONDÔNIA&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;RO&#39;</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;SÃO PAULO&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;SP&#39;</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;DISTRITO FEDERAL&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;DF&#39;</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;GOIÁS&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;GO&#39;</span>
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=w>    </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;00&#39;</span>
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=k>END</span>
</code></pre></div> <p>Além dos estados, caso as novas atualizações não possuam a identificação do município, deve-se verificar se o mesmo polígono de desmatamento se encontra em mais de um município ao mesmo tempo, o que pode ser alcançado com a query abaixo. <strong>Vale ressaltar que os passos descritos abaixo só devem ser executados caso o INPE não identifique o município onde ocorreu o desmatamento.</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=k>SELECT</span><span class=w> </span><span class=n>prodes</span><span class=p>.</span><span class=n>gid</span><span class=p>,</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=n>city</span><span class=p>.</span><span class=o>*</span><span class=p>)</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=k>FROM</span><span class=w> </span><span class=n>prodes2019</span><span class=w> </span><span class=n>prodes</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>municipios_cerrado</span><span class=w> </span><span class=n>city</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>city</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>prodes</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>prodes</span><span class=p>.</span><span class=n>gid</span><span class=w> </span><span class=k>HAVING</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=n>city</span><span class=p>.</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span>
</code></pre></div> <p>Em seguida, deve-se copiar os polígonos PRODES-Cerrado 2019 para uma tabela alternativa <code>prodes2019_alt</code> (que possui o campo de município) dividindo o polígono nas porções que pertencem a cada município. Esta operação irá aumentar a quantidade de polígonos no banco, porém não irá impactar na área desmatada.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>prodes2019</span><span class=w> </span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=k>ADD</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>county</span><span class=w> </span><span class=nb>character</span><span class=w> </span><span class=nb>varying</span><span class=p>(</span><span class=mi>60</span><span class=p>);</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>prodes2019_alt</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=k>state</span><span class=p>,</span><span class=w> </span><span class=n>path_row</span><span class=p>,</span><span class=w> </span><span class=n>class_name</span><span class=p>,</span><span class=w> </span><span class=n>image_date</span><span class=p>,</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>area_km2</span><span class=p>,</span><span class=w> </span><span class=n>uf</span><span class=p>,</span><span class=w> </span><span class=n>county</span><span class=p>,</span><span class=w> </span><span class=n>geom</span><span class=p>)</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=k>select</span><span class=w> </span><span class=n>prodes</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>prodes</span><span class=p>.</span><span class=k>state</span><span class=p>,</span><span class=w> </span><span class=n>prodes</span><span class=p>.</span><span class=n>path_row</span><span class=p>,</span><span class=w> </span><span class=n>prodes</span><span class=p>.</span><span class=n>class_name</span><span class=p>,</span><span class=w> </span><span class=n>prodes</span><span class=p>.</span><span class=n>image_date</span><span class=p>,</span><span class=w> </span><span class=n>prodes</span><span class=p>.</span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>prodes</span><span class=p>.</span><span class=n>area_m2</span><span class=p>,</span><span class=w> </span><span class=n>prodes</span><span class=p>.</span><span class=n>uf</span><span class=p>,</span><span class=w> </span><span class=n>city</span><span class=p>.</span><span class=n>nm_municip</span><span class=p>,</span><span class=w> </span><span class=n>ST_Multi</span><span class=p>(</span><span class=n>ST_INTERSECTION</span><span class=p>(</span><span class=n>prodes</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>city</span><span class=p>.</span><span class=n>geom</span><span class=p>))</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>prodes2019</span><span class=w> </span><span class=n>prodes</span><span class=w> </span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>municipios_cerrado</span><span class=w> </span><span class=n>city</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>prodes</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>city</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span>
</code></pre></div> <p>Além de criar o campo <code>county</code>, deve-se também já armazenar o valor da área do desmatamento de cada polígono na tabela <code>prodes2019_alt</code> já convertendo para km².</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>update</span><span class=w> </span><span class=n>prodes2019_alt</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=k>set</span><span class=w> </span><span class=n>area_km2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ST_AREA</span><span class=p>(</span><span class=n>geom</span><span class=p>::</span><span class=n>GEOGRAPHY</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=k>where</span><span class=w> </span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2019</span>
</code></pre></div> <p>Por fim, deve-se inserir os polígonos PRODES-Cerrado 2019 na tabela oficial onde estão todos os polígonos, incluindo a longitude e latitude do Centróide do polígono.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=p>(</span><span class=n>uid</span><span class=p>,</span><span class=w> </span><span class=n>pathrow</span><span class=p>,</span><span class=w> </span><span class=n>view_date</span><span class=p>,</span><span class=w> </span><span class=k>source</span><span class=p>,</span><span class=w> </span><span class=n>areamunkm</span><span class=p>,</span><span class=w> </span><span class=n>uf</span><span class=p>,</span><span class=w> </span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>classname</span><span class=p>,</span><span class=w> </span><span class=n>lat</span><span class=p>,</span><span class=w> </span><span class=n>long</span><span class=p>)</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=k>select</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>path_row</span><span class=p>,</span><span class=w> </span><span class=n>image_date</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;inpe cerrado&#39;</span><span class=w> </span><span class=p>,</span><span class=w> </span><span class=n>area_m2</span><span class=p>,</span><span class=w> </span><span class=n>uf</span><span class=p>,</span><span class=w> </span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>class_name</span><span class=p>,</span><span class=w> </span><span class=n>st_y</span><span class=p>(</span><span class=n>ST_PointOnSurface</span><span class=p>(</span><span class=n>geom</span><span class=p>)),</span><span class=w> </span><span class=n>st_x</span><span class=p>(</span><span class=n>ST_PointOnSurface</span><span class=p>(</span><span class=n>geom</span><span class=p>))</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>prodes2019_alt</span>
</code></pre></div> <h3 id=deter-cerrado>DETER Cerrado<a class=headerlink href=#deter-cerrado title="Permanent link">&para;</a></h3> <p>Devido a constante revisão do DETER-Cerrado, onde polígonos de desmatamento são reanalisados e validados antes de sua consolidação no PRODES-Cerrado, ao atualizar este produto é necessário excluir todos os dados anteriores sobre ele e inserir o novo por completo. Para tal, o primeiro passo é excluir os registros na tabela <code>deter_cerrado</code>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=ss>&quot;public&quot;</span><span class=p>.</span><span class=ss>&quot;pontos_campo&quot;</span><span class=w> </span><span class=k>DROP</span><span class=w> </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=ss>&quot;pontos_campo_deter_id_fkey&quot;</span><span class=p>;</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=k>TRUNCATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>deter_cerrado</span><span class=w> </span><span class=k>RESTART</span><span class=w> </span><span class=k>IDENTITY</span><span class=p>;</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=ss>&quot;public&quot;</span><span class=p>.</span><span class=ss>&quot;pontos_campo&quot;</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=ss>&quot;pontos_campo_deter_id_fkey&quot;</span><span class=w> </span><span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=n>deter_id</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>deter_cerrado</span><span class=p>(</span><span class=n>gid</span><span class=p>);</span>
</code></pre></div> <p>Obs. Caso seja necessário desativar e reativar mais restrições (CONSTRAINTS), utilize a query abaixo para encontrar todas as restrições presentes no banco e em seguida a query seguinte para descobrir todas as queries de reconstrução das constraints.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=cm>/*</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=cm>DROP CONSTRAINTS SCRIPT</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=cm>*/</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=s1>&#39;ALTER TABLE &quot;&#39;</span><span class=o>||</span><span class=n>nspname</span><span class=o>||</span><span class=s1>&#39;&quot;.&quot;&#39;</span><span class=o>||</span><span class=n>relname</span><span class=o>||</span><span class=s1>&#39;&quot; DROP CONSTRAINT &quot;&#39;</span><span class=o>||</span><span class=n>conname</span><span class=o>||</span><span class=s1>&#39;&quot;;&#39;</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>pg_constraint</span><span class=w> </span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=w> </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>pg_class</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>conrelid</span><span class=o>=</span><span class=n>pg_class</span><span class=p>.</span><span class=n>oid</span><span class=w> </span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=w> </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>pg_namespace</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>pg_namespace</span><span class=p>.</span><span class=n>oid</span><span class=o>=</span><span class=n>pg_class</span><span class=p>.</span><span class=n>relnamespace</span><span class=w> </span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>contype</span><span class=o>=</span><span class=s1>&#39;f&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>END</span><span class=p>,</span><span class=n>contype</span><span class=p>,</span><span class=n>nspname</span><span class=p>,</span><span class=n>relname</span><span class=p>,</span><span class=n>conname</span>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a>
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=cm>/*</span>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=cm>RECREATE CONSTRAINTS SCRIPT:</span>
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=cm>*/</span>
<a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a>
<a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a><span class=k>SELECT</span><span class=w> </span><span class=s1>&#39;ALTER TABLE &quot;&#39;</span><span class=o>||</span><span class=n>nspname</span><span class=o>||</span><span class=s1>&#39;&quot;.&quot;&#39;</span><span class=o>||</span><span class=n>relname</span><span class=o>||</span><span class=s1>&#39;&quot; ADD CONSTRAINT &quot;&#39;</span><span class=o>||</span><span class=n>conname</span><span class=o>||</span><span class=s1>&#39;&quot; &#39;</span><span class=o>||</span>
<a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a><span class=w>   </span><span class=n>pg_get_constraintdef</span><span class=p>(</span><span class=n>pg_constraint</span><span class=p>.</span><span class=n>oid</span><span class=p>)</span><span class=o>||</span><span class=s1>&#39;;&#39;</span>
<a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>pg_constraint</span>
<a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a><span class=w> </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>pg_class</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>conrelid</span><span class=o>=</span><span class=n>pg_class</span><span class=p>.</span><span class=n>oid</span>
<a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a><span class=w> </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>pg_namespace</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>pg_namespace</span><span class=p>.</span><span class=n>oid</span><span class=o>=</span><span class=n>pg_class</span><span class=p>.</span><span class=n>relnamespace</span>
<a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>contype</span><span class=o>=</span><span class=s1>&#39;f&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>END</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=n>contype</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=n>nspname</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=n>relname</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=n>conname</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span>
</code></pre></div> <p>Em seguida, deve-se realizar o download do <a href=http://terrabrasilis.dpi.inpe.br/geonetwork/srv/eng/catalog.search#/metadata/e6e15388-4ca9-49b9-aec9-03891339a35e>Shapefile</a> com todos os Avisos Deter-Cerrado e em seguida pode-se inserir o shape em uma tabela temporária no banco de dados, nomeada <code>deter_public</code>, através do comando:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>shp2pgsql<span class=w> </span>-s<span class=w> </span><span class=m>4674</span><span class=w> </span>-W<span class=w> </span><span class=s2>&quot;UTF-8&quot;</span><span class=w> </span>deter_public.shp<span class=w> </span>public.deter_public<span class=w> </span><span class=p>|</span><span class=w> </span>psql<span class=w> </span>-h<span class=w> </span>&lt;host_address&gt;<span class=w> </span>-U<span class=w> </span>&lt;db_user&gt;<span class=w> </span>-d<span class=w> </span>&lt;db_name&gt;
</code></pre></div> <p>Com o shape carregado na tabela <code>deter_public</code> no banco de dados, basta popular a tabela <code>deter_cerrado</code> com o seguinte comando em SQL:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>deter_cerrado</span><span class=w> </span><span class=p>(</span><span class=n>classname</span><span class=p>,</span><span class=w> </span><span class=n>path_row</span><span class=p>,</span><span class=w> </span><span class=n>view_date</span><span class=p>,</span><span class=w> </span><span class=n>sensor</span><span class=p>,</span><span class=w> </span><span class=n>satellite</span><span class=p>,</span><span class=w> </span><span class=n>areamunkm</span><span class=p>,</span><span class=w> </span><span class=n>county</span><span class=p>,</span><span class=w> </span><span class=n>uf</span><span class=p>,</span><span class=w> </span><span class=n>uc</span><span class=p>,</span><span class=w> </span><span class=n>geom</span><span class=p>)</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=k>select</span><span class=w> </span><span class=n>classname</span><span class=p>,</span><span class=w> </span><span class=n>path_row</span><span class=p>,</span><span class=w> </span><span class=n>view_date</span><span class=p>,</span><span class=w> </span><span class=n>sensor</span><span class=p>,</span><span class=w> </span><span class=n>satellite</span><span class=p>,</span><span class=w> </span><span class=n>areamunkm</span><span class=p>,</span><span class=w> </span><span class=n>municipali</span><span class=p>,</span><span class=w> </span><span class=n>uf</span><span class=p>,</span><span class=w> </span><span class=n>uc</span><span class=p>,</span><span class=w> </span><span class=n>geom</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>deter_public</span>
</code></pre></div> <p>Por fim, deve-se também atualizar a latitude e longitude do centróide do polígono DETER-Cerrado:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>update</span><span class=w> </span><span class=n>deter_cerrado</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=k>set</span><span class=w> </span><span class=n>lat</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>st_y</span><span class=p>(</span><span class=n>ST_PointOnSurface</span><span class=p>(</span><span class=n>geom</span><span class=p>)),</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=w>    </span><span class=n>long</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>st_x</span><span class=p>(</span><span class=n>ST_PointOnSurface</span><span class=p>(</span><span class=n>geom</span><span class=p>))</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=k>where</span><span class=w> </span><span class=n>lat</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=k>null</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>long</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=k>null</span><span class=p>;</span>
</code></pre></div> <p>Após a inserção dos pontos, deve-se excluir os polígonos que já foram antropizados e reconhecido pelo PRODES-Cerrado, utilizando a query abaixo:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>deter_cerrado</span><span class=w> </span><span class=n>d</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=k>USING</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>p</span><span class=w> </span>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=k>WHERE</span><span class=w> </span><span class=n>ST_EQUALS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>geom</span><span class=p>);</span>
</code></pre></div> <h3 id=cadastro-ambiental-rural-car>Cadastro Ambiental Rural (CAR)<a class=headerlink href=#cadastro-ambiental-rural-car title="Permanent link">&para;</a></h3> <p>Após a criação dos quatro shapefiles com os principais componentes do CAR (Propriedades Rurais, Reserva Legal, Área de Preservação Permanence e Nascentes) deve-se inserir corretamente estes dados no banco de dados.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>shp2pgsql<span class=w> </span>-s<span class=w> </span><span class=m>4674</span><span class=w> </span>-W<span class=w> </span><span class=s2>&quot;UTF-8&quot;</span><span class=w> </span>car.shp<span class=w> </span>public.car_cerrado_temp<span class=w> </span><span class=p>|</span><span class=w> </span>psql<span class=w> </span>-h<span class=w> </span>&lt;host_address&gt;<span class=w> </span>-U<span class=w> </span>&lt;db_user&gt;<span class=w> </span>-d<span class=w> </span>&lt;db_name&gt;
</code></pre></div> <h3 id=cruzamentos-espaciais-entre-os-dados>Cruzamentos espaciais entre os dados<a class=headerlink href=#cruzamentos-espaciais-entre-os-dados title="Permanent link">&para;</a></h3> <h4 id=prodes-e-deter-cerrado-com-o-car>PRODES e DETER-Cerrado com o CAR<a class=headerlink href=#prodes-e-deter-cerrado-com-o-car title="Permanent link">&para;</a></h4> <p>Após realizar a atualização dos dados PRODES-Cerrado, DETER-Cerrado e do CAR é necessário realizar os cruzamentos espaciais entre estes dados. Portanto, primeiramente é importante apagar os registros anteriores. Inicialmente iremos apagar a tabela de relacionamento entre os dados do CAR e os polígonos PRODES e DETER-Cerrado.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=k>TRUNCATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>car_desmat</span><span class=w> </span><span class=k>RESTART</span><span class=w> </span><span class=k>IDENTITY</span><span class=p>;</span>
</code></pre></div> <p>Em seguida, inicialmente deve-se inserir (em relação de 1:1) o cruzamento entre as propriedades do CAR e os polígonos PRODES-Cerrado na tabela <code>car_desmat</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>car_desmat</span><span class=w> </span><span class=p>(</span><span class=n>car_cerrado_id</span><span class=p>,</span><span class=w> </span><span class=n>idt_imovel</span><span class=p>,</span><span class=w> </span><span class=n>prodes_id</span><span class=p>)</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=k>select</span><span class=w> </span><span class=n>car</span><span class=p>.</span><span class=n>gid</span><span class=p>,</span><span class=w> </span><span class=n>car</span><span class=p>.</span><span class=n>idt_imovel</span><span class=p>,</span><span class=w> </span><span class=n>prodes</span><span class=p>.</span><span class=n>gid</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>car_cerrado</span><span class=w> </span><span class=n>car</span><span class=w> </span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>prodes</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>car</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>prodes</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>prodes</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>2013</span>
</code></pre></div> <p>Após o PRODES-Cerrado, insere-se os cruzamentos com o DETER-Cerrado:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>car_desmat</span><span class=w> </span><span class=p>(</span><span class=n>car_cerrado_id</span><span class=p>,</span><span class=w> </span><span class=n>idt_imovel</span><span class=p>,</span><span class=w> </span><span class=n>deter_id</span><span class=p>)</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=k>select</span><span class=w> </span><span class=n>car</span><span class=p>.</span><span class=n>gid</span><span class=p>,</span><span class=w> </span><span class=n>car</span><span class=p>.</span><span class=n>idt_imovel</span><span class=p>,</span><span class=w> </span><span class=n>prodes</span><span class=p>.</span><span class=n>gid</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>car_cerrado</span><span class=w> </span><span class=n>car</span><span class=w> </span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>deter_cerrado</span><span class=w> </span><span class=n>deter</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>car</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>deter</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span>
</code></pre></div> <p>Com as relações criadas, atualiza-se a tabela <code>car_desmat</code> com a quantidade de nascentes e cada desmatamento detectado dentro de uma propriedade rural:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=k>update</span><span class=w> </span><span class=n>car_desmat</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=k>set</span><span class=w> </span><span class=n>qnt_nascente</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sub</span><span class=p>.</span><span class=n>qnt</span><span class=w> </span>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=k>from</span><span class=w> </span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=w>    </span><span class=p>(</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=w>      </span><span class=k>select</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>car_cerrado_id</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internocar</span><span class=p>,</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>prodes_id</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internoprodes</span><span class=p>,</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=n>rl</span><span class=p>.</span><span class=n>gid</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>qnt</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=w>      </span><span class=k>from</span><span class=w> </span><span class=n>geo_car_nascente_cerrado</span><span class=w> </span><span class=n>rl</span>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=w>      </span><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>car_desmat</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>idt_imovel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rl</span><span class=p>.</span><span class=n>idt_imovel</span><span class=w> </span>
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=w>      </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=w>     </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>sub</span><span class=w> </span>
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=k>where</span><span class=w> </span><span class=n>sub</span><span class=p>.</span><span class=n>internocar</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>car_desmat</span><span class=p>.</span><span class=n>car_cerrado_id</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>sub</span><span class=p>.</span><span class=n>internoprodes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>car_desmat</span><span class=p>.</span><span class=n>prodes_id</span>
</code></pre></div> <h4 id=prodes-e-deter-cerrado-com-o-car_1>PRODES e DETER-Cerrado com o CAR<a class=headerlink href=#prodes-e-deter-cerrado-com-o-car_1 title="Permanent link">&para;</a></h4> <p>Após realizar a atualização dos dados PRODES-Cerrado e DETER-Cerrado é necessário realizar os cruzamentos espaciais entre estes dados e as áreas tratadas como Especiais pelo Cerrado DPAT, tais como:</p> <ul> <li><em>Terras Indígenas (TI).</em></li> <li><em>Comunidades Quilombolas (AQ).</em></li> <li><em>Unidades de Conservação de Uso Sustentável (UCUS).</em> </li> <li><em>Unidades de Conversavação de Proteção Integral (UCPI).</em></li> </ul> <p>O tipo de cruzamento a ser realizado é o cálculo das distâncias entre cada polígono PRODES e/ou DETER e cada área especial, no intuito de descobrir a área mais próxima de cada polígono.</p> <p>Portanto, primeiramente é importante apagar os registros anteriores. Inicialmente iremos apagar a tabela de relacionamento entre os dados do PRODES/DETER e as áreas especiais. A fim de facilitar, iremos utilizar ``<em>{origin_table}</em>'' para identificar a tabela de origem, seja ela PRODES ou DETER-Cerrado. <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=k>TRUNCATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=err>{</span><span class=n>origin_table</span><span class=err>}</span><span class=n>_distancias</span><span class=w> </span><span class=k>RESTART</span><span class=w> </span><span class=k>IDENTITY</span><span class=p>;</span>
</code></pre></div></p> <p>Em seguida, inicialmente deve-se inserir (em relação de 1:1) o cruzamento entre a área especial de TI e os polígonos {origin-table}-Cerrado na tabela <code>{origin_table}_distancias</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=err>{</span><span class=n>origin_table</span><span class=err>}</span><span class=n>_distancias</span><span class=w> </span><span class=p>(</span><span class=err>{</span><span class=n>origin_table</span><span class=err>}</span><span class=n>_id</span><span class=p>,</span><span class=w> </span><span class=n>ti_gid</span><span class=p>,</span><span class=w> </span><span class=n>ti_dist</span><span class=p>)</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=k>select</span><span class=w> </span>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=n>a</span><span class=p>.</span><span class=n>gid</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=err>{</span><span class=n>origin_table</span><span class=err>}</span><span class=n>_id</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>gid</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>ti_gid</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>distance</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>distance</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=k>from</span><span class=w> </span><span class=err>{</span><span class=n>origin_table</span><span class=err>}</span><span class=n>_cerrado</span><span class=w> </span><span class=n>a</span><span class=w> </span>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=k>cross</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=k>lateral</span>
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=w>    </span><span class=p>(</span><span class=k>select</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>gid</span><span class=p>,</span><span class=w> </span>
<a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=w>    </span><span class=c1>-- (a.geom::geography &lt;-&gt; b.geom::geography)/1000.0 as distance </span>
<a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a><span class=w>     </span><span class=k>CAST</span><span class=p>(</span><span class=n>ST_DistanceSphere</span><span class=p>(</span><span class=n>a</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span><span class=o>/</span><span class=mi>1000</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nb>numeric</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>distance</span>
<a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a><span class=w>    </span><span class=k>from</span><span class=w> </span><span class=n>areas_quilombolas</span><span class=w> </span><span class=n>b</span><span class=w> </span>
<a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a><span class=w>    </span><span class=c1>--where st_dwithin(a.geom,b.geom,400) -- caso queira filtrar por distância mínima</span>
<a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a><span class=w>    </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>distance</span><span class=w> </span><span class=k>asc</span><span class=w> </span><span class=k>limit</span><span class=w> </span><span class=mi>1</span>
<a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>b</span>
</code></pre></div> <p>Em seguida, atualiza-se os demais campos referentes a Comunidades Quilombola (colunas q_gid, q_dist em deter_distancias e tabela 'areas_quilombolas'), UCUS (colunas ucus_gid, ucus_dist em deter_distancias e tabela 'ucs_uso_sustentavel') e UCPI (colunas ucpi_gid, ucpi_dist em deter_distancias e tabela 'ucs_protecao_integral') na tabela de relacionamento:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=k>update</span><span class=w> </span><span class=n>deter_distancias</span><span class=w> </span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=k>set</span><span class=w> </span><span class=n>q_gid</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>gid</span><span class=p>,</span>
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=n>q_dist</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>distance</span>
<a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=k>from</span><span class=w> </span><span class=n>deter_cerrado</span><span class=w> </span><span class=n>a</span>
<a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=k>cross</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=k>lateral</span>
<a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=w>    </span><span class=p>(</span><span class=k>select</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>gid</span><span class=p>,</span><span class=w> </span>
<a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=w>    </span><span class=c1>-- (a.geom::geography &lt;-&gt; b.geom::geography)/1000.0 as distance </span>
<a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a><span class=w>     </span><span class=k>CAST</span><span class=p>(</span><span class=n>ST_DistanceSphere</span><span class=p>(</span><span class=n>a</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span><span class=o>/</span><span class=mi>1000</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nb>numeric</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>distance</span>
<a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a><span class=w>    </span><span class=k>from</span><span class=w> </span><span class=n>areas_quilombolas</span><span class=w> </span><span class=n>b</span><span class=w> </span>
<a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a><span class=w>    </span><span class=c1>--where st_dwithin(a.geom,b.geom,400) -- caso queira filtrar por distância mínima</span>
<a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a><span class=w>    </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>distance</span><span class=w> </span><span class=k>asc</span><span class=w> </span><span class=k>limit</span><span class=w> </span><span class=mi>1</span>
<a id=__codelineno-22-12 name=__codelineno-22-12 href=#__codelineno-22-12></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>b</span>
<a id=__codelineno-22-13 name=__codelineno-22-13 href=#__codelineno-22-13></a><span class=k>where</span><span class=w> </span><span class=n>deter_distancias</span><span class=p>.</span><span class=n>deter_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>gid</span><span class=w> </span>
</code></pre></div> <h4 id=prodes-cerrado-com-os-pontos-da-validacao-de-campo>PRODES-Cerrado com os pontos da Validação de Campo<a class=headerlink href=#prodes-cerrado-com-os-pontos-da-validacao-de-campo title="Permanent link">&para;</a></h4> <p>Após atualização dos dado PRODES-Cerrado, é necessária a atualização da referência ao polígono PRODES-Cerrado em relação aos pontos visitados durante a validação de campo. Para tal, executasse a seguinte query:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=k>UPDATE</span><span class=w> </span><span class=n>pontos_campo</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=k>set</span><span class=w> </span><span class=n>prodes_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>gid</span>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=k>from</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>p</span>
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=k>where</span><span class=w> </span><span class=n>pontos_campo</span><span class=p>.</span><span class=n>prodes_id</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=k>null</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>pontos_campo</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span>
</code></pre></div> <p>Em seguida, realiza-se o mesmo processo em relação aos polígonos DETER-Cerrado:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=k>UPDATE</span><span class=w> </span><span class=n>pontos_campo</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=k>set</span><span class=w> </span><span class=n>deter_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>gid</span>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=k>from</span><span class=w> </span><span class=n>deter_cerrado</span><span class=w> </span><span class=n>d</span>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=k>where</span><span class=w> </span><span class=n>pontos_campo</span><span class=p>.</span><span class=n>deter_id</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=k>null</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>d</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>pontos_campo</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span>
</code></pre></div> <h4 id=prodes-cerrado-com-os-pontos-da-validacao-amostral>PRODES-Cerrado com os pontos da Validação Amostral<a class=headerlink href=#prodes-cerrado-com-os-pontos-da-validacao-amostral title="Permanent link">&para;</a></h4> <p>Após atualização dos dado PRODES-Cerrado, é necessária a atualização da referência ao polígono PRODES-Cerrado em relação aos pontos inspecionados durante a validação amostral. Para tal, executasse a seguinte query:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=k>UPDATE</span><span class=w> </span><span class=n>validacao_amostral</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=k>set</span><span class=w> </span><span class=n>prodes_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>gid</span>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=k>from</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>p</span>
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=k>where</span><span class=w> </span><span class=n>validacao_amostral</span><span class=p>.</span><span class=n>prodes_id</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=k>null</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>validacao_amostral</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span>
</code></pre></div> <h4 id=prodes-cerrado-acumulado-em-todas-regioes-municipios-e-estados>PRODES-Cerrado acumulado em todas regiões (Municípios e Estados)<a class=headerlink href=#prodes-cerrado-acumulado-em-todas-regioes-municipios-e-estados title="Permanent link">&para;</a></h4> <p>Após a atualização do PRODES-Cerrado, também é necessário o cálculo do desmatamento acumulado por município e também por estado. Para tal, deve-se inicialmente popular a tabela <code>prodes_regions</code> que irá armazenar o <code>id</code> da região (município ou estado) e a sua área desmatada. Note que deve-se atualizar a referêcia <code>where p.year = 2019</code> para o ano do desmatamento inserido no banco. Portanto, pode-se utilizar a seguinte query:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=cm>/* Inserir desmatamento acumulado por estado */</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>prodes_regions</span><span class=w> </span><span class=p>(</span><span class=n>region_id</span><span class=p>,</span><span class=w> </span><span class=n>sum_area_prodes</span><span class=p>,</span><span class=w> </span><span class=k>year</span><span class=p>)</span>
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=k>select</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=p>,</span><span class=w> </span><span class=k>sum</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>areamunkm</span><span class=p>),</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>uf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2019</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;state&#39;</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>3</span>
<a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a>
<a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=cm>/* Inserir desmatamento acumulado por município */</span>
<a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>prodes_regions</span><span class=w> </span><span class=p>(</span><span class=n>region_id</span><span class=p>,</span><span class=w> </span><span class=n>sum_area_prodes</span><span class=p>,</span><span class=w> </span><span class=k>year</span><span class=p>)</span>
<a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=k>select</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=p>,</span><span class=w> </span><span class=k>sum</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>areamunkm</span><span class=p>),</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2019</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;city&#39;</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>3</span>
</code></pre></div> <p>Em seguida, deve-se atualizar os elementos recém inseridos na tabela <code>prodes_regions</code> com a área desmatada dentro de APPs e Reservas Legais:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=cm>/* Atualização para desmatameto acumulado em APP e RL por estado */</span>
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=cm>/* APP */</span>
<a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=k>update</span><span class=w> </span><span class=n>prodes_regions</span>
<a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=k>set</span><span class=w> </span><span class=n>area_app</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>area_desmat</span>
<a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=k>from</span><span class=w> </span>
<a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>safe_intersection</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)::</span><span class=n>geography</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>area_desmat</span><span class=p>,</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internoregion</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internoyear</span>
<a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=k>from</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>p</span><span class=w> </span>
<a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>geo_car_app_cerrado</span><span class=w> </span><span class=n>lc</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>uf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>uf</span>
<a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>uf</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;state&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2019</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span><span class=w>  </span><span class=k>as</span><span class=w> </span><span class=n>internal</span>
<a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a><span class=k>where</span><span class=w> </span><span class=n>prodes_regions</span><span class=p>.</span><span class=n>region_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>internoregion</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>prodes_regions</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>internoyear</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>internoyear</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2019</span>
<a id=__codelineno-27-12 name=__codelineno-27-12 href=#__codelineno-27-12></a>
<a id=__codelineno-27-13 name=__codelineno-27-13 href=#__codelineno-27-13></a><span class=cm>/* RL */</span>
<a id=__codelineno-27-14 name=__codelineno-27-14 href=#__codelineno-27-14></a><span class=k>update</span><span class=w> </span><span class=n>prodes_regions</span>
<a id=__codelineno-27-15 name=__codelineno-27-15 href=#__codelineno-27-15></a><span class=k>set</span><span class=w> </span><span class=n>area_rl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>area_desmat</span>
<a id=__codelineno-27-16 name=__codelineno-27-16 href=#__codelineno-27-16></a><span class=k>from</span><span class=w> </span>
<a id=__codelineno-27-17 name=__codelineno-27-17 href=#__codelineno-27-17></a><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>safe_intersection</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)::</span><span class=n>geography</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>area_desmat</span><span class=p>,</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internoregion</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internoyear</span>
<a id=__codelineno-27-18 name=__codelineno-27-18 href=#__codelineno-27-18></a><span class=k>from</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>p</span><span class=w> </span>
<a id=__codelineno-27-19 name=__codelineno-27-19 href=#__codelineno-27-19></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>geo_car_reserva_legal_cerrado</span><span class=w> </span><span class=n>lc</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>uf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>uf</span>
<a id=__codelineno-27-20 name=__codelineno-27-20 href=#__codelineno-27-20></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>uf</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;state&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2019</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span><span class=w>  </span><span class=k>as</span><span class=w> </span><span class=n>internal</span>
<a id=__codelineno-27-21 name=__codelineno-27-21 href=#__codelineno-27-21></a><span class=k>where</span><span class=w> </span><span class=n>prodes_regions</span><span class=p>.</span><span class=n>region_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>internoregion</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>prodes_regions</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>internoyear</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>internoyear</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2019</span>
<a id=__codelineno-27-22 name=__codelineno-27-22 href=#__codelineno-27-22></a>
<a id=__codelineno-27-23 name=__codelineno-27-23 href=#__codelineno-27-23></a><span class=cm>/* Atualização para desmatameto acumulado em APP e RL por município */</span>
<a id=__codelineno-27-24 name=__codelineno-27-24 href=#__codelineno-27-24></a>
<a id=__codelineno-27-25 name=__codelineno-27-25 href=#__codelineno-27-25></a><span class=cm>/* APP */</span>
<a id=__codelineno-27-26 name=__codelineno-27-26 href=#__codelineno-27-26></a><span class=k>update</span><span class=w> </span><span class=n>prodes_regions</span>
<a id=__codelineno-27-27 name=__codelineno-27-27 href=#__codelineno-27-27></a><span class=k>set</span><span class=w> </span><span class=n>area_app</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>area_desmat</span>
<a id=__codelineno-27-28 name=__codelineno-27-28 href=#__codelineno-27-28></a><span class=k>from</span><span class=w> </span>
<a id=__codelineno-27-29 name=__codelineno-27-29 href=#__codelineno-27-29></a><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>safe_intersection</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)::</span><span class=n>geography</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>area_desmat</span><span class=p>,</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internoregion</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internoyear</span>
<a id=__codelineno-27-30 name=__codelineno-27-30 href=#__codelineno-27-30></a><span class=k>from</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>p</span><span class=w> </span>
<a id=__codelineno-27-31 name=__codelineno-27-31 href=#__codelineno-27-31></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>geo_car_app_cerrado</span><span class=w> </span><span class=n>lc</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>cd_geocmu</span>
<a id=__codelineno-27-32 name=__codelineno-27-32 href=#__codelineno-27-32></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;city&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2019</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span><span class=w>  </span><span class=k>as</span><span class=w> </span><span class=n>internal</span>
<a id=__codelineno-27-33 name=__codelineno-27-33 href=#__codelineno-27-33></a><span class=k>where</span><span class=w> </span><span class=n>prodes_regions</span><span class=p>.</span><span class=n>region_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>internoregion</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>prodes_regions</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>internoyear</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>internoyear</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2019</span>
<a id=__codelineno-27-34 name=__codelineno-27-34 href=#__codelineno-27-34></a>
<a id=__codelineno-27-35 name=__codelineno-27-35 href=#__codelineno-27-35></a><span class=cm>/* RL */</span>
<a id=__codelineno-27-36 name=__codelineno-27-36 href=#__codelineno-27-36></a><span class=k>update</span><span class=w> </span><span class=n>prodes_regions</span>
<a id=__codelineno-27-37 name=__codelineno-27-37 href=#__codelineno-27-37></a><span class=k>set</span><span class=w> </span><span class=n>area_rl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>area_desmat</span>
<a id=__codelineno-27-38 name=__codelineno-27-38 href=#__codelineno-27-38></a><span class=k>from</span><span class=w> </span>
<a id=__codelineno-27-39 name=__codelineno-27-39 href=#__codelineno-27-39></a><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>safe_intersection</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)::</span><span class=n>geography</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>area_desmat</span><span class=p>,</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internoregion</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internoyear</span>
<a id=__codelineno-27-40 name=__codelineno-27-40 href=#__codelineno-27-40></a><span class=k>from</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>p</span><span class=w> </span>
<a id=__codelineno-27-41 name=__codelineno-27-41 href=#__codelineno-27-41></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>geo_car_reserva_legal_cerrado</span><span class=w> </span><span class=n>lc</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>cd_geocmu</span>
<a id=__codelineno-27-42 name=__codelineno-27-42 href=#__codelineno-27-42></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;city&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2019</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span><span class=w>  </span><span class=k>as</span><span class=w> </span><span class=n>internal</span>
<a id=__codelineno-27-43 name=__codelineno-27-43 href=#__codelineno-27-43></a><span class=k>where</span><span class=w> </span><span class=n>prodes_regions</span><span class=p>.</span><span class=n>region_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>internoregion</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>prodes_regions</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>internoyear</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>internoyear</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2019</span>
</code></pre></div> <h4 id=prodes-cerrado-com-todas-regioes-municipios-e-estados-em-relacao-ao-uso-do-solo>PRODES-Cerrado com todas regiões (Municípios e Estados) em relação ao uso do solo<a class=headerlink href=#prodes-cerrado-com-todas-regioes-municipios-e-estados-em-relacao-ao-uso-do-solo title="Permanent link">&para;</a></h4> <p>Após atualização do PRODES-Cerrado, também é necessário o cálculo da proporção de desmatamento em cada tipo de uso do solo para os polígonos recém inseridos no banco de dados. Desta forma, para calcular e inserir no banco esta informação para estados e municípios respectivamente deve-se executar as seguintes queries. Após as queries de inserção dos dados, é necessário ajustar a coluna <code>total_area_classe_lulc</code> da tabela <code>prodes_regions_lulc</code>, que representa o total da área de cada classe de uso solo dos mapas.</p> <div class=highlight><pre><span></span><code>Terraclass
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=w> </span><span class=p>(</span><span class=n>region_id</span><span class=p>,</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=k>type</span><span class=p>,</span><span class=w> </span><span class=n>classe_lulc</span><span class=p>,</span><span class=w> </span><span class=n>color</span><span class=p>,</span><span class=w> </span><span class=n>desmat_area_classe_lulc</span><span class=p>,</span><span class=w> </span><span class=n>fonte</span><span class=p>)</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=k>select</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;state&#39;</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=p>,</span><span class=w> </span><span class=k>g</span><span class=p>.</span><span class=n>color</span><span class=p>,</span>
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=w>    </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>safe_intersection</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)::</span><span class=n>geography</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;terraclass&#39;</span>
<a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=k>from</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span>
<a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>uso_solo_terraclass</span><span class=w> </span><span class=n>lc</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>uf</span>
<a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>uf</span>
<a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>graphic_colors</span><span class=w> </span><span class=k>g</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>unaccent</span><span class=p>(</span><span class=k>g</span><span class=p>.</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=k>ilike</span><span class=w> </span><span class=n>unaccent</span><span class=p>(</span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=p>)</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>g</span><span class=p>.</span><span class=n>table_rel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;uso_solo_terraclass&#39;</span>
<a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a><span class=w>    </span><span class=k>where</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;state&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2019</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>;</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=w> </span><span class=p>(</span><span class=n>region_id</span><span class=p>,</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=k>type</span><span class=p>,</span><span class=w> </span><span class=n>classe_lulc</span><span class=p>,</span><span class=w> </span><span class=n>color</span><span class=p>,</span><span class=w> </span><span class=n>desmat_area_classe_lulc</span><span class=p>,</span><span class=w> </span><span class=n>fonte</span><span class=p>)</span>
<a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a><span class=k>select</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;city&#39;</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=p>,</span><span class=w> </span><span class=k>g</span><span class=p>.</span><span class=n>color</span><span class=p>,</span>
<a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=w>    </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>safe_intersection</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)::</span><span class=n>geography</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;terraclass&#39;</span>
<a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=k>from</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span>
<a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>uso_solo_probio</span><span class=w> </span><span class=n>lc</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>cd_geocmu</span>
<a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>cd_geocmu</span>
<a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>graphic_colors</span><span class=w> </span><span class=k>g</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>unaccent</span><span class=p>(</span><span class=k>g</span><span class=p>.</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=k>ilike</span><span class=w> </span><span class=n>unaccent</span><span class=p>(</span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=p>)</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>g</span><span class=p>.</span><span class=n>table_rel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;uso_solo_terraclass&#39;</span>
<a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a><span class=w>    </span><span class=k>where</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;city&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>2000</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>2012</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>;</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=cm>/* Atualização do campo `total_area_classe_lulc` */</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>
<a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=cm>/* Por Município */</span>
<a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=k>update</span><span class=w> </span><span class=n>prodes_regions_lulc</span>
<a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=k>set</span><span class=w> </span><span class=n>total_area_classe_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>total_area_lulc</span>
<a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=k>from</span>
<a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a><span class=p>(</span><span class=k>select</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>code</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>classeInt</span><span class=p>,</span><span class=w>  </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=k>true</span><span class=p>)</span><span class=o>/</span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total_area_lulc</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>uso_solo_terraclass</span><span class=w> </span><span class=n>lc</span>
<a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>bioma</span><span class=o>=</span><span class=s1>&#39;CERRADO&#39;</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internal</span>
<a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a><span class=k>where</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;city&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=p>.</span><span class=n>region_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=p>.</span><span class=n>classe_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>classeInt</span>
<a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a>
<a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a><span class=cm>/* Por Estado */</span>
<a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a><span class=k>update</span><span class=w> </span><span class=n>prodes_regions_lulc</span>
<a id=__codelineno-30-13 name=__codelineno-30-13 href=#__codelineno-30-13></a><span class=k>set</span><span class=w> </span><span class=n>total_area_classe_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>total_area_lulc</span>
<a id=__codelineno-30-14 name=__codelineno-30-14 href=#__codelineno-30-14></a><span class=k>from</span>
<a id=__codelineno-30-15 name=__codelineno-30-15 href=#__codelineno-30-15></a><span class=p>(</span><span class=k>select</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>code</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>classeInt</span><span class=p>,</span><span class=w>  </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=k>true</span><span class=p>)</span><span class=o>/</span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total_area_lulc</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>uso_solo_terraclass</span><span class=w> </span><span class=n>lc</span>
<a id=__codelineno-30-16 name=__codelineno-30-16 href=#__codelineno-30-16></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>uf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;state&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>bioma</span><span class=o>=</span><span class=s1>&#39;CERRADO&#39;</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internal</span>
<a id=__codelineno-30-17 name=__codelineno-30-17 href=#__codelineno-30-17></a><span class=k>where</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;state&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=p>.</span><span class=n>region_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=p>.</span><span class=n>classe_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>classeInt</span>
</code></pre></div> <div class=highlight><pre><span></span><code>PROBIO
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=w> </span><span class=p>(</span><span class=n>region_id</span><span class=p>,</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=k>type</span><span class=p>,</span><span class=w> </span><span class=n>classe_lulc</span><span class=p>,</span><span class=w> </span><span class=n>color</span><span class=p>,</span><span class=w> </span><span class=n>desmat_area_classe_lulc</span><span class=p>,</span><span class=w> </span><span class=n>fonte</span><span class=p>)</span>
<a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=k>select</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;state&#39;</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=p>,</span><span class=w> </span><span class=k>g</span><span class=p>.</span><span class=n>color</span><span class=p>,</span>
<a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=w>    </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>safe_intersection</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)::</span><span class=n>geography</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;probio&#39;</span>
<a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=k>from</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span>
<a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>uso_solo_probio</span><span class=w> </span><span class=n>lc</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>uf</span>
<a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>uf</span>
<a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>graphic_colors</span><span class=w> </span><span class=k>g</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>unaccent</span><span class=p>(</span><span class=k>g</span><span class=p>.</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=k>ilike</span><span class=w> </span><span class=n>unaccent</span><span class=p>(</span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=p>)</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>g</span><span class=p>.</span><span class=n>table_rel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;uso_solo_probio&#39;</span>
<a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a><span class=k>where</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;state&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>2000</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>2013</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>;</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=w> </span><span class=p>(</span><span class=n>region_id</span><span class=p>,</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=k>type</span><span class=p>,</span><span class=w> </span><span class=n>classe_lulc</span><span class=p>,</span><span class=w> </span><span class=n>color</span><span class=p>,</span><span class=w> </span><span class=n>desmat_area_classe_lulc</span><span class=p>,</span><span class=w> </span><span class=n>fonte</span><span class=p>)</span>
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=k>select</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;city&#39;</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=p>,</span><span class=w> </span><span class=k>g</span><span class=p>.</span><span class=n>color</span><span class=p>,</span>
<a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a><span class=w>    </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>safe_intersection</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)::</span><span class=n>geography</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;probio&#39;</span>
<a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a><span class=k>from</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span>
<a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>uso_solo_probio</span><span class=w> </span><span class=n>lc</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>cd_geocmu</span>
<a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>cd_geocmu</span>
<a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>graphic_colors</span><span class=w> </span><span class=k>g</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>unaccent</span><span class=p>(</span><span class=k>g</span><span class=p>.</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=k>ilike</span><span class=w> </span><span class=n>unaccent</span><span class=p>(</span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=p>)</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>g</span><span class=p>.</span><span class=n>table_rel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;uso_solo_probio&#39;</span>
<a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a><span class=w>    </span><span class=k>where</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;city&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>2000</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>2012</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>;</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=cm>/* Atualização do campo `total_area_classe_lulc` */</span>
<a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a>
<a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=cm>/* Por Município */</span>
<a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=k>update</span><span class=w> </span><span class=n>prodes_regions_lulc</span>
<a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a><span class=k>set</span><span class=w> </span><span class=n>total_area_classe_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>total_area_lulc</span>
<a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a><span class=k>from</span>
<a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a><span class=p>(</span><span class=k>select</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>code</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>classeInt</span><span class=p>,</span><span class=w>  </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=k>true</span><span class=p>)</span><span class=o>/</span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total_area_lulc</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>uso_solo_probio</span><span class=w> </span><span class=n>lc</span>
<a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>bioma</span><span class=o>=</span><span class=s1>&#39;CERRADO&#39;</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internal</span>
<a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a><span class=k>where</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;city&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=p>.</span><span class=n>region_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=p>.</span><span class=n>classe_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>classeInt</span>
<a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a>
<a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a><span class=cm>/* Por Estado */</span>
<a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a><span class=k>update</span><span class=w> </span><span class=n>prodes_regions_lulc</span>
<a id=__codelineno-33-13 name=__codelineno-33-13 href=#__codelineno-33-13></a><span class=k>set</span><span class=w> </span><span class=n>total_area_classe_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>total_area_lulc</span>
<a id=__codelineno-33-14 name=__codelineno-33-14 href=#__codelineno-33-14></a><span class=k>from</span>
<a id=__codelineno-33-15 name=__codelineno-33-15 href=#__codelineno-33-15></a><span class=p>(</span><span class=k>select</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>code</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>classeInt</span><span class=p>,</span><span class=w>  </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=k>true</span><span class=p>)</span><span class=o>/</span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total_area_lulc</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>uso_solo_probio</span><span class=w> </span><span class=n>lc</span>
<a id=__codelineno-33-16 name=__codelineno-33-16 href=#__codelineno-33-16></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>uf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;state&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>bioma</span><span class=o>=</span><span class=s1>&#39;CERRADO&#39;</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internal</span>
<a id=__codelineno-33-17 name=__codelineno-33-17 href=#__codelineno-33-17></a><span class=k>where</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;state&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=p>.</span><span class=n>region_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=p>.</span><span class=n>classe_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>classeInt</span>
</code></pre></div> <div class=highlight><pre><span></span><code>Agrosatélite
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=w> </span><span class=p>(</span><span class=n>region_id</span><span class=p>,</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=k>type</span><span class=p>,</span><span class=w> </span><span class=n>classe_lulc</span><span class=p>,</span><span class=w> </span><span class=n>color</span><span class=p>,</span><span class=w> </span><span class=n>desmat_area_classe_lulc</span><span class=p>,</span><span class=w> </span><span class=n>fonte</span><span class=p>)</span>
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a><span class=k>select</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;state&#39;</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=p>,</span><span class=w> </span><span class=k>g</span><span class=p>.</span><span class=n>color</span><span class=p>,</span>
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=w>    </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>safe_intersection</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)::</span><span class=n>geography</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;agrosatelite&#39;</span>
<a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=k>from</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span>
<a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>agricultura_agrosatelite</span><span class=w> </span><span class=n>lc</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>uf</span>
<a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>uf</span>
<a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>graphic_colors</span><span class=w> </span><span class=k>g</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>unaccent</span><span class=p>(</span><span class=k>g</span><span class=p>.</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=k>ilike</span><span class=w> </span><span class=n>unaccent</span><span class=p>(</span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=p>)</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>g</span><span class=p>.</span><span class=n>table_rel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;agricultura_agrosatelite&#39;</span>
<a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a><span class=w>    </span><span class=k>where</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;state&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2019</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>;</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=w> </span><span class=p>(</span><span class=n>region_id</span><span class=p>,</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=k>type</span><span class=p>,</span><span class=w> </span><span class=n>classe_lulc</span><span class=p>,</span><span class=w> </span><span class=n>color</span><span class=p>,</span><span class=w> </span><span class=n>desmat_area_classe_lulc</span><span class=p>,</span><span class=w> </span><span class=n>fonte</span><span class=p>)</span>
<a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a><span class=k>select</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;city&#39;</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=p>,</span><span class=w> </span><span class=k>g</span><span class=p>.</span><span class=n>color</span><span class=p>,</span>
<a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=w>    </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>safe_intersection</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)::</span><span class=n>geography</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;agrosatelite&#39;</span>
<a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a><span class=k>from</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span>
<a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>agricultura_agrosatelite</span><span class=w> </span><span class=n>lc</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>cd_geocmu</span>
<a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>prodes_cerrado</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>cd_geocmu</span>
<a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>graphic_colors</span><span class=w> </span><span class=k>g</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>unaccent</span><span class=p>(</span><span class=k>g</span><span class=p>.</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=k>ilike</span><span class=w> </span><span class=n>unaccent</span><span class=p>(</span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=p>)</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>g</span><span class=p>.</span><span class=n>table_rel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;agricultura_agrosatelite&#39;</span>
<a id=__codelineno-35-8 name=__codelineno-35-8 href=#__codelineno-35-8></a><span class=w>    </span><span class=k>where</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;city&#39;</span><span class=w>  </span><span class=k>and</span><span class=w> </span><span class=n>ST_INTERSECTS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>)</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2019</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>;</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=cm>/* Atualização do campo `total_area_classe_lulc` */</span>
<a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>
<a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a><span class=cm>/* Por Município */</span>
<a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a><span class=k>update</span><span class=w> </span><span class=n>prodes_regions_lulc</span>
<a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a><span class=k>set</span><span class=w> </span><span class=n>total_area_classe_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>total_area_lulc</span>
<a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a><span class=k>from</span>
<a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a><span class=p>(</span><span class=k>select</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>code</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>classeInt</span><span class=p>,</span><span class=w>  </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=k>true</span><span class=p>)</span><span class=o>/</span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total_area_lulc</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>agricultura_agrosatelite</span><span class=w> </span><span class=n>lc</span>
<a id=__codelineno-36-8 name=__codelineno-36-8 href=#__codelineno-36-8></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>cd_geocmu</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>bioma</span><span class=o>=</span><span class=s1>&#39;CERRADO&#39;</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internal</span>
<a id=__codelineno-36-9 name=__codelineno-36-9 href=#__codelineno-36-9></a><span class=k>where</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;city&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=p>.</span><span class=n>region_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=p>.</span><span class=n>classe_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>classeInt</span>
<a id=__codelineno-36-10 name=__codelineno-36-10 href=#__codelineno-36-10></a>
<a id=__codelineno-36-11 name=__codelineno-36-11 href=#__codelineno-36-11></a><span class=cm>/* Por Estado */</span>
<a id=__codelineno-36-12 name=__codelineno-36-12 href=#__codelineno-36-12></a><span class=k>update</span><span class=w> </span><span class=n>prodes_regions_lulc</span>
<a id=__codelineno-36-13 name=__codelineno-36-13 href=#__codelineno-36-13></a><span class=k>set</span><span class=w> </span><span class=n>total_area_classe_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>total_area_lulc</span>
<a id=__codelineno-36-14 name=__codelineno-36-14 href=#__codelineno-36-14></a><span class=k>from</span>
<a id=__codelineno-36-15 name=__codelineno-36-15 href=#__codelineno-36-15></a><span class=p>(</span><span class=k>select</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>gid</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>code</span><span class=p>,</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>classe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>classeInt</span><span class=p>,</span><span class=w>  </span><span class=k>sum</span><span class=p>(</span><span class=n>st_area</span><span class=p>(</span><span class=n>lc</span><span class=p>.</span><span class=n>geom</span><span class=p>,</span><span class=k>true</span><span class=p>)</span><span class=o>/</span><span class=mi>1000000</span><span class=p>.</span><span class=mi>0</span><span class=p>::</span><span class=n>double</span><span class=w> </span><span class=k>precision</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total_area_lulc</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>agricultura_agrosatelite</span><span class=w> </span><span class=n>lc</span>
<a id=__codelineno-36-16 name=__codelineno-36-16 href=#__codelineno-36-16></a><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>regions</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>uf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;state&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>lc</span><span class=p>.</span><span class=n>bioma</span><span class=o>=</span><span class=s1>&#39;CERRADO&#39;</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>internal</span>
<a id=__codelineno-36-17 name=__codelineno-36-17 href=#__codelineno-36-17></a><span class=k>where</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;state&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=p>.</span><span class=n>region_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>prodes_regions_lulc</span><span class=p>.</span><span class=n>classe_lulc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>internal</span><span class=p>.</span><span class=n>classeInt</span>
</code></pre></div> </article> </div> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Voltar ao topo </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2022 Araticum - Articulação pela Restauração do Cerrado </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copiado para \u00e1rea de transfer\u00eancia", "clipboard.copy": "Copiar para \u00e1rea de transfer\u00eancia", "search.result.more.one": "Mais 1 nesta p\u00e1gina", "search.result.more.other": "Mais # nesta p\u00e1gina", "search.result.none": "Nenhum resultado encontrado", "search.result.one": "1 resultado encontrado", "search.result.other": "# resultados encontrados", "search.result.placeholder": "Digite para iniciar a busca", "search.result.term.missing": "Ausente", "select.version": "Selecione a vers\u00e3o"}}</script> <script src=../assets/javascripts/bundle.dff1b7c8.min.js></script> </body> </html>