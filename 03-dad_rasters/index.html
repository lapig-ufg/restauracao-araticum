<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Luiz Pascoal, Renato Gomes Silvério e Tharles de Sousa Andrade" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Rasters - Documentação - Plataforma da Rede de Articulação pela Restauração do Cerrado</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Rasters";
        var mkdocs_page_input_path = "03-dad_rasters.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Documentação - Plataforma da Rede de Articulação pela Restauração do Cerrado
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">HOME</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Guia do usuário</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../01-guia_dados_geograficos/">Dados Geográficos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../01-guia_metricas_de_qualidade/">Métricas de Qualidade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../01-guia_funcionalidades/">Funcionalidades</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../01-guia_relatorios/">Relatórios</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Dados</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../03-dad_vetoriais/">Vetoriais</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Rasters</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#estrutura-de-diretorios">Estrutura de diretórios</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#processo-de-atualizacao">Processo de atualização</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#mosaicos-landsat">Mosaicos Landsat</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mosaicos-sentinel-2">Mosaicos Sentinel-2</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#disponibilizacao-no-ows-server">Disponibilização no OWS Server</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Arquitetura de Software</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../02-arq_geral/">Visão geral</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../02-arq_servidor_de_mapas/">Servidor de mapas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../02-arq_servidor_de_aplicacao/">Servidor de aplicação</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../02-arq_execucao_dpat/">Deployment da arquitetura do Cerrado DPAT</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../04-metricas_de_avaliacao/">Métricas de Avaliação</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Documentação - Plataforma da Rede de Articulação pela Restauração do Cerrado</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Dados &raquo;</li><li>Rasters</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="dados-rasters">Dados Rasters</h1>
<p>Os dados Rasters são imagens com informações geográficas e estão armazenados no sistema de arquivos do servidor. A configuração da pasta do local de armazenamento destes arquivos é feita no <em>OWS Server</em> na linha 54 do arquivo <a href="https://github.com/lapig-ufg/lapig-maps/blob/master/src/ows/config.js">config.js</a>, através da variável <code>config['path_catalog']</code>. Esta configuração deverá apresentar a pasta com o catálogo de dados a serem disponibilizados no OWS Server.</p>
<h2 id="estrutura-de-diretorios">Estrutura de diretórios</h2>
<p>Todos os dados geográficos Raster do projeto podem ser encontrados no <a href="https://drive.google.com/file/d/1L2pW2PudSsmwGQMhPGXbZd5sJvBmEcSW/view?usp=sharing">link</a>.</p>
<p>Após a descompactação do arquivo <code>DADOS_RASTER_CATALOG_FIP_CERRADO.tar.gz</code> os dados estão armazenados em diferentes subpastas. Considerando os dados catalogados na seção <a href="../01-guia_dados_geograficos/">Dados Geográficos</a> e o diretório configurado no <code>config.js</code> temos os seguintes dados em formato raster:</p>
<table>
<thead>
<tr>
<th>Dado</th>
<th>Nome do arquivo</th>
<th align="right">Subpasta</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="../01-guia_dados_geograficos/#Susceptibilidade ao desmatamento">Susceptibilidade a Desmatamentos Grandes</a></td>
<td>bi_ce_susceptibilidade_desmatamento_maiores_100_na_lapig.tif</td>
<td align="right">/FIP</td>
</tr>
<tr>
<td><a href="../01-guia_dados_geograficos/#Susceptibilidade ao desmatamento">Susceptibilidade a Desmatamentos Pequenos</a></td>
<td>bi_ce_susceptibilidade_desmatamento_menores_100_na_lapig.tif</td>
<td align="right">/FIP</td>
</tr>
<tr>
<td><a href="../01-guia_dados_geograficos/#Altitude">Altitude</a></td>
<td>bi_ce_srtm_altitude_30_2000_lapig.tif</td>
<td align="right">/Relevo</td>
</tr>
<tr>
<td><a href="../01-guia_dados_geograficos/#Declividade">Declividade</a></td>
<td>bi_ce_srtm_declividade_30_2000_lapig.tif</td>
<td align="right">/Relevo</td>
</tr>
<tr>
<td><a href="../01-guia_dados_geograficos/#Média da Precipitação Acumulada">Média da Precipitação Acumulada</a></td>
<td>bi_ce_precipitacao_historica_30_lapig.tif</td>
<td align="right">/Água</td>
</tr>
<tr>
<td><a href="../01-guia_dados_geograficos/#Mosaico Landsat">Mosaico Landsat 2000-2019</a></td>
<td>bi_ce_mosaico_landsat_completo_30_2000_fip.tif <br/> bi_ce_mosaico_landsat_completo_30_2002_fip.tif <br/> bi_ce_mosaico_landsat_completo_30_2004_fip.tif <br/>   bi_ce_mosaico_landsat_completo_30_2006_fip.tif  <br/>  bi_ce_mosaico_landsat_completo_30_2008_fip.tif <br/> bi_ce_mosaico_landsat_completo_30_2010_fip.tif <br/> bi_ce_mosaico_landsat_completo_30_2012_fip.tif <br/> bi_ce_mosaico_landsat_completo_30_2013_fip.tif <br/> bi_ce_mosaico_landsat_completo_30_2014_fip.tif <br/> bi_ce_mosaico_landsat_completo_30_2015_fip.tif <br/> bi_ce_mosaico_landsat_completo_30_2016_fip.tif <br/> bi_ce_mosaico_landsat_completo_30_2017_fip.tif <br/> bi_ce_mosaico_landsat_completo_30_2018_fip.tif <br/> bi_ce_mosaico_landsat_completo_30_2019_fip.tif <br/></td>
<td align="right">/img_satelites/bi_ce_mosaico_landsat_30_fip</td>
</tr>
<tr>
<td><a href="../01-guia_dados_geograficos/#Mosaico Landsat">Mosaico Sentinel 2016-2019</a></td>
<td>bi_ce_mosaico_sentinel_10_2016_lapig.tif <br/> bi_ce_mosaico_sentinel_10_2017_lapig.tif <br/> bi_ce_mosaico_sentinel_10_2018_lapig.tif <br/> bi_ce_mosaico_sentinel_10_2019_lapig.tif</td>
<td align="right">/img_satelites/bi_ce_mosaico_sentinel_10_lapig</td>
</tr>
</tbody>
</table>
<h2 id="processo-de-atualizacao">Processo de atualização</h2>
<h3 id="mosaicos-landsat">Mosaicos Landsat</h3>
<p>Os mosaicos Landsat disponibilizados para visualização no Cerrado DPAT são os mesmos utilizados pelo INPE para inspeção visual e detecção das áreas desmatadas pelo sistema PRODES-Cerrado. Tais imagens podem ser <a href="https://earthexplorer.usgs.gov/">baixadas pelo portal Earth Explorer</a> de acordo com a data e a órbita-ponto presentes no arqivo shapefile <a href="http://terrabrasilis.dpi.inpe.br/download/dataset/cerrado-prodes/vector/yearly_deforestation_2002_2019_cerrado_biome.zip">disponibilizado pelo INPE no portal Terrabrasilis</a>. Após o download do arquivo compactado correspondente a cada imagem, devem ser criadas composições multibandas com as bandas do vermelho, infravermelho, e infravermelho de ondas curtas. Uma outra forma mais simples para a obtenção destas imagens é o contato direto com a equipe do LAPIG através do e-mail cerradodpat.lapig@ufg.br.</p>
<p>Com as imagens devidamente armazenadas, dois scripts correspondentes ao recorte do limite util da cena e a criação do mosaico das imagens de cada ano são executados simultaneamente por meio da execução do arquivo <a href="../sh/run.sh">run.sh</a> , que irá chamar o arquivo <a href="../sh/clip_landsat.sh">clip_landsat.sh</a>. No arquivo run.shp é necessário que se edite as seguintes linhas:</p>
<p><code>INPUT_DIR=""</code> Diretório "raiz" para as cenas isoladas de cada ano (linha 3).<br />
<code>OUTPUT_DIR=""</code> Diretório de saída com os mosaicos de cada ano (linha 4).<br />
<code>DIRS=""</code> Diretórios com os anos a serem mosaicados. (linha 5)  </p>
<p>No arquivo clip_landsat.sh, a edição é feita na seguinte linha:</p>
<p><code>INPUT_GRID=""</code> Arquivo no formato shapefile com os limites das cenas Landsat. (linha 10)</p>
<p>Após as edições deve-se executar o seguinte comando:</p>
<pre><code>sh run.sh
</code></pre>
<p>As imagens no formato TIF de cada ano estarão disponiveis na pasta apontada em <code>OUTPUT_DIR</code>. </p>
<h3 id="mosaicos-sentinel-2">Mosaicos Sentinel-2</h3>
<p>As imagens Sentinel-2 foram baixadas por meio da plataforma <a href="https://earthengine.google.com/">Google Earth Engine</a>. Devido a caracteristica sazonal do bioma Cerrado, um mesmo alvo pode apresentar diferentes respostas espectrais durante os diferentes meses do ano. Assim, para que o mosaico apresentasse um padrão mais homogêneo entre as cenas, buscou-se por imagens dentro de um curto periodo de tempo. Foram priorizadas imagens para o periodo de um mês. No caso da indisponibilidade de imagens sem nuvens, o periodo foi estendido até que o intervalo entre maio e outubro fosse alcançado. Destaca-se também que diferentes padrões climáticos podem ser encontrado no bioma, dificultando assim a identificação de imagens sem nuvens. Dessa forma, diferentes geometrias foram criadas para a seleção de imagens em regiões específicas (ex: norte do bioma, próximo ao litoral maranhense). O código para o download do mosaico Sentinel-2 <a href="https://code.earthengine.google.com/e45dab08c30a7e688558032a30382792">encontra-se disponivel para acesso</a>.</p>
<p>Devido ao limite de tamanho o mosaico baixado é dividido em tiles. A junção dos tiles em um único arquivo é feita a partir dos comandos gdalbuildvrt e gdal_translate presentes no pacote <a href="https://gdal.org/python/">GDAL</a>.</p>
<pre><code>gdalbuildvrt mosaic_&quot;$ano&quot;.vrt mosaic_&quot;$ano&quot;* -srcnodata 0 -vrtnodata 0

gdal_translate mosaic_&quot;$ano&quot;.vrt mosaic_&quot;$ano&quot;.tif -co COMPRESS=LZW -co BIGTIFF=YES -co TILED=YES -a_nodata 0
</code></pre>
<p>Onde <code>$ano</code> é o ano de cada mosaico, presente no nome dos tiles correspondentes a imagem baixada.</p>
<h3 id="disponibilizacao-no-ows-server">Disponibilização no OWS Server</h3>
<p>Após a criação dos arquivos únicos para os mosaicos Landsat e Sentinel, antes de disponibilizar o mosaico ao OWS Server é necessário a criação das pirâmides para níveis diferentes de visualização do mosaico. Para criar a visualização em níveis, execute o comando:</p>
<pre><code class="language-sh">gdaladdo --config USE_RRD=YES -ro &lt;nome_arquivo.tif&gt; 2 4 8
</code></pre>
<p>Ao finalizar o processamento, é importante definir o valor das bandas para a coloração do mosaico, o que pode ser alcançado com o apoio do QGIS, ao clicar com o botão direito sobre a camada -&gt; propriedades -&gt; simbologia na opção.A imagem abaixo apresenta um exemplo de definição do valor das bandas aplicadas ao mosaico Sentinel de 2018.</p>
<p><img alt="Exemplo de bandas." src="../imgs/03/exemplo_bandas.png" /></p>
<p>Por fim, pode-se então disponibilizar o mosaico como camada no Mapserver através de um <a href="../02-arq_servidor_de_mapas/#Processo de atualização">mapfile</a>. Um exemplo de mapfile para criação da camada com o mosaico Sentinel de 2018 pode ser visualizada abaixo:</p>
<pre><code>LAYER
  NAME &quot;bi_ce_mosaico_sentinel_10_2018_lapig&quot;
  DATA &quot;img_satelites/bi_ce_mosaico_sentinel_10_lapig/bi_ce_mosaico_sentinel_10_2018_lapig.tif&quot;
  EXTENT -60.1094198 -24.6846260 -41.5220189 -2.3262773
  METADATA
    &quot;ows_title&quot; &quot;Mosaico Sentinel do Bioma Cerrado&quot;
    &quot;ows_abstract&quot; &quot;A geração dos mosaicos considerou, para cada cena e ano, a melhor imagem (i.e. com a menor cobertura de nuvens) adquirida no período de junho à setembro.&quot;
    &quot;gml_exclude_items&quot; &quot;the_geom&quot;
    &quot;gml_include_items&quot; &quot;all&quot;
    &quot;gml_geometries&quot;  &quot;the_geom&quot;
  END
  PROJECTION
    &quot;init=epsg:4674&quot;
  END
  STATUS ON
  TYPE Raster
  TEMPLATE &quot;DUMMY&quot;
  OFFSITE 0 0 0
  PROCESSING &quot;SCALE_1=748,1405&quot;
  PROCESSING &quot;SCALE_2=613,1534&quot;
  PROCESSING &quot;SCALE_3=385,2134&quot;
  PROCESSING &quot;BANDS=3,2,1&quot;
END
</code></pre>
<p>É importante ressaltar a inserção do parâmetro <code>PROCESSING "SCALE_"</code> ao Mapfile permitindo informar ao Mapserver os valores de bandas definidos anteriormente.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../03-dad_vetoriais/" class="btn btn-neutral float-left" title="Vetoriais"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../02-arq_geral/" class="btn btn-neutral float-right" title="Visão geral">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../03-dad_vetoriais/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../02-arq_geral/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
